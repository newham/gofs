<!DOCTYPE html>
<html>

<head>
    <title id="head-title">Video Player</title>
    <link rel="shortcut icon" href="/public/img/icon/icon-video.png" type="image/x-icon">
    <link rel="stylesheet" href="/public/css/page-home.css">
    <link rel="stylesheet" href="/public/css/player.css">
    <link rel="stylesheet" href="/public/css/ul.css">
</head>

<body>
    <div class="main">
        <div class="title">
            <!-- <label style="color:var(--main-color);">正在播放:</label> -->
            <i class="icon icon-m icon-video-m"></i>
            <label id="title"></label>
        </div>
        <div class="video-box">
            <video id="videoElement" controls autoplay></video>
        </div>
    </div>
    <div class="side">
        <div class="title-list"><label>播放列表</label></div>
        <ul id="play-list">
        </ul>
    </div>
</body>
<script type="text/javascript" charset="utf-8" src="/public/js/jquery.min.js"></script>
<script type="text/javascript" charset="utf-8" src="/public/js/flv.min.js"></script>
<script>
    var current = 0

    var play_list

    function play(i) {
        var video = play_list.Files[i]
        if (flvjs.isSupported()) {
            var videoElement = document.getElementById('videoElement');
            var flvPlayer = flvjs.createPlayer({
                type: video.Suffix,
                url: encodeURI(`/file/${video.Path}`)
            });
            flvPlayer.attachMediaElement(videoElement);
            flvPlayer.load();
            flvPlayer.play();
            $("#title").html(video.Name)
            $("#head-title").html(video.Name)
            set_act_li(i) //set act li
        }
    }

    function set_play_list() {
        play_list = JSON.parse('{{.playList}}')
        for (i = 0; i < play_list.Files.length; i++) {
            $("#play-list").append(`<li id="li-${i}" onclick="play(${i})"> ${play_list.Files[i].Name} </li>`)
        }
    }

    function set_act_li(i) {
        if (current > -1) {
            $(`#li-${current}`).removeClass('act')
        }
        $(`#li-${i}`).addClass('act')
        current = i
    }

    $(document).ready(() => {
        set_play_list()
        play(Number('{{.id}}'))
    })
</script>

</html>